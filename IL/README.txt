文件：
data.txt中包含98209个国标麻将对局记录，文件较大，建议不要在文件编辑器中打开，否则可能卡死。
sample.txt中包含前16个对局，用于查看并熟悉格式。

每一局的数据格式：
（1）第一行为Match <ID>，可以用https://botzone.org.cn/match/<ID>作为链接在浏览器中查看对局演示。
（2）第二行为Wind 0..3，表示本局的圈风（0~3分别表示东、北、西、南）。
（3）接下来四行为Player <N> Deal XX XX ...，表示四名玩家的初始13张手牌，这里的Player 0~3分别表示东、北、西、南四个位置上的玩家。所有麻将牌均以“大写字母+数字”组合表示。如：“W4”表示“四万”，“B6”表示“六筒”，“T8”表示“八条”，“F1”～“F4”表示“东南西北”，“J1”～“J3”表示“中发白”。
（4）接下来为对局过程，有这样几种格式：
Player <N> Draw XX #玩家摸牌，XX为摸到的牌
Player <N> Play XX #玩家打牌，XX为打出的牌
Player <N> Chi XX #玩家吃牌，XX为吃牌后形成的顺子中间一张牌，被吃的牌是上一行前一个玩家打出的牌。如上一个玩家打B7，吃牌后形成B7B8B9顺子，则XX为B8。
Player <N> Peng XX #玩家碰牌，XX为被碰的牌，一定等于上一行被打出的牌。
Player <N> Gang XX #玩家杠牌（明杠），XX为被杠的牌，一定等于上一行被打出的牌。
Player <N> AnGang XX #玩家杠牌（暗杠），XX为被杠的牌，不一定等于上一行摸到的牌。
Player <N> BuGang XX #玩家补杠，XX为补杠的牌，不一定等于上一行摸到的牌。
Player <N> Hu XX #玩家和牌，XX为所胡的牌，可能是自摸（前一行为摸牌）、点和（前一行为打牌）、抢杠和（前一行为补杠）。
【注意】在Peng, Gang, Hu的格式中，可能在本行后面存在一个或多个Ignore Player <N> Chi/Peng/Gang/Hu XX，表示在上一个玩家打牌后，有多个玩家同时宣布吃/碰/杠/胡（优先级为和>碰/杠>吃，同优先级按出牌人逆时针顺序），Ignore表示被忽略的操作。
举例：
Player 2 Play B3
Player 1 Hu B3 Ignore Player 0 PENG B3 Ignore Player 3 CHI B4
表示2号位打3饼，3号位吃、0号位碰、1号位胡，实际结果为1号位胡，另外两个操作被忽略。
Player 1 Play W7
Player 2 Hu W7 Ignore Player 0 HU W7
表示1号位打7万，0号位和2号位同时胡，实际结果为2号位胡，0号位操作被忽略（截胡）。
（5）对局结束有两种情况，要么某玩家胡牌，要么流局（荒庄）。如果是胡牌，在胡牌信息之后两行为：
Fan <F> <Description>
Score <S1> <S2> <S3> <S4>
表示胡牌番数、番型以及得分情况。如果是流局，在正常对局信息之后两行为：
Huang
Score 0 0 0 0


国标，不计花牌，只有东南西北中发白，万子、条子、筒子
手牌向量的embedding:
4*4*9的手牌表示；
前34个为实际有效元素,1-9个为万,10-18为筒,19-27为饼,28-31为风牌,32-34为箭牌
第0维是手牌数目 j1j2有i张的话，b[0:i-1][j1][j2] = 1
使用kernel_size=3, stride=1, padding=1的卷积经过多层resnet提取高级特征

历史向量的embedding:
## 稀疏embedding格式baseline（core idea是分成四个部分，每一部分用one-hot向量编码，再concat成一个长向量）：

1. 执行动作的玩家 (Acting Player):

需要4位 one-hot 编码 (例如, 玩家1: [0,1,0,0])
如果某些信息不直接关联单个玩家（如开局信息），可以有一个“全局”或“系统”的标识。
动作类型 (Action Type): 这是最关键的部分，需要覆盖所有基本操作。


2. 定义如下动作类型：

需要11位 one-hot 编码
DRAW(摸牌，对应编号0)
PLAY_TILE (出牌，对应编号1)
PENG (碰牌并出牌，对应编号2)
CHI (吃牌并出牌，对应编号3)
GANG (杠牌，需要区分暗杠、明杠，对应编号4)
ANGANG (暗杠 - 若上一回合为摸牌，对应编号5)
BUGANG (补杠，对应编号7)
WIN (和牌，可能需要区分自摸、点炮，对应编号9)
NO_ACTION (填充或无意义时间步，对应编号10)


3. 主要涉及的牌张1 (Primary Card):

需要35位 one-hot 编码
国标麻将有字牌（东南西北中发白）、万子（1-9）、筒子（1-9）、条子（1-9），共35种。
可以为每种牌分配一个唯一的ID。
额外加一个“无牌”(None) 的状态。 #*这里是针对无牌的动作来的
例如：
PLAY_TILE: 打出的牌
SELF_DRAW_TILE: 摸到的牌
PENG: 碰完后打出的牌 (被碰的牌是上一张打出的牌，是上下文信息)
CHI: 吃牌顺子的中间张 (Card1)
GANG: 杠的牌
BUGANG: 补杠的牌


4. 次要涉及的牌张2 (Secondary Card):

同样需要约 35 位 one-hot 编码。
主要用于：
CHI: 吃完后打出的牌 (Card2)
其他大多数动作，此字段为“无牌”


5. 动作成功性（2维）:
可能会有多个玩家同时吃碰杠胡。
[1,0]成功，[0,1]失败，[0,0] padding


组合向量的构建示例：

假设我们有：

4位 (玩家)
11位 (动作类型)
35位 (牌张1)
35位 (牌张2)
4位 (圈风)
4位 (门风)
2位 动作成功性

那么每个时间步的输入向量大约是 4 + 11 + 35 + 35 + 4 + 4 + 2 = 95 维
两个风向是否嵌入存疑。

将初始历史特征放入时序模型处理，高级历史特征与手牌特征进行crossAttention
方案可以是：最终，以手牌为query，历史特征为key和value，进行crossAttention，Q再接MLP输出
也可以以历史特征为query，手牌特征为key和value，进行crossAttention,相当于改进历史特征